INFO:drake:Meshcat listening for connections at http://localhost:7000
WARNING:drake:warning: Warning: In vtkGLTFDocumentLoaderInternals.cxx, line 1354: vtkGLTFDocumentLoader (0x5f4e60cec710): glTF extension KHR_texture_basisu is used in this model, but not supported by this loader. The extension will be ignored.
/home/yyan-admin/yl43338/env/lib/python3.10/site-packages/stable_baselines3/common/env_checker.py:462: UserWarning: We recommend you to use a symmetric and normalized Box action space (range=[-1, 1]) cf. https://stable-baselines3.readthedocs.io/en/master/guide/rl_tips.html
  warnings.warn(
/home/yyan-admin/yl43338/env/lib/python3.10/site-packages/stable_baselines3/common/env_checker.py:473: UserWarning: Your action space has dtype float64, we recommend using np.float32 to avoid cast errors.
  warnings.warn(
Creating PPO model...
Using cpu device
Wrapping the env with a `Monitor` wrapper
Wrapping the env in a DummyVecEnv.
Total number of parameters: 392975
Logging to runs/0419/PPO_32
---------------------------------
| rollout/           |          |
|    ep_len_mean     | 74       |
|    ep_rew_mean     | 59.1     |
| time/              |          |
|    fps             | 23       |
|    iterations      | 1        |
|    time_elapsed    | 85       |
|    total_timesteps | 2048     |
---------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 69.3        |
|    ep_rew_mean          | 55.6        |
| time/                   |             |
|    fps                  | 22          |
|    iterations           | 2           |
|    time_elapsed         | 186         |
|    total_timesteps      | 4096        |
| train/                  |             |
|    approx_kl            | 0.014214805 |
|    clip_fraction        | 0.0952      |
|    clip_range           | 0.2         |
|    entropy_loss         | -9.97       |
|    explained_variance   | -0.000316   |
|    learning_rate        | 0.0003      |
|    loss                 | 9.03        |
|    n_updates            | 10          |
|    policy_gradient_loss | -0.0203     |
|    std                  | 1.01        |
|    value_loss           | 27.5        |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 67.5        |
|    ep_rew_mean          | 54.1        |
| time/                   |             |
|    fps                  | 22          |
|    iterations           | 3           |
|    time_elapsed         | 278         |
|    total_timesteps      | 6144        |
| train/                  |             |
|    approx_kl            | 0.011635421 |
|    clip_fraction        | 0.103       |
|    clip_range           | 0.2         |
|    entropy_loss         | -9.99       |
|    explained_variance   | 0.047       |
|    learning_rate        | 0.0003      |
|    loss                 | 15.7        |
|    n_updates            | 20          |
|    policy_gradient_loss | -0.0202     |
|    std                  | 1.01        |
|    value_loss           | 55          |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 67.6        |
|    ep_rew_mean          | 54          |
| time/                   |             |
|    fps                  | 22          |
|    iterations           | 4           |
|    time_elapsed         | 361         |
|    total_timesteps      | 8192        |
| train/                  |             |
|    approx_kl            | 0.015588786 |
|    clip_fraction        | 0.177       |
|    clip_range           | 0.2         |
|    entropy_loss         | -9.97       |
|    explained_variance   | 0.022       |
|    learning_rate        | 0.0003      |
|    loss                 | 23.7        |
|    n_updates            | 30          |
|    policy_gradient_loss | -0.0316     |
|    std                  | 1           |
|    value_loss           | 62.7        |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 69.1        |
|    ep_rew_mean          | 55.4        |
| time/                   |             |
|    fps                  | 23          |
|    iterations           | 5           |
|    time_elapsed         | 442         |
|    total_timesteps      | 10240       |
| train/                  |             |
|    approx_kl            | 0.009938657 |
|    clip_fraction        | 0.105       |
|    clip_range           | 0.2         |
|    entropy_loss         | -9.95       |
|    explained_variance   | 0.106       |
|    learning_rate        | 0.0003      |
|    loss                 | 32.9        |
|    n_updates            | 40          |
|    policy_gradient_loss | -0.0315     |
|    std                  | 1           |
|    value_loss           | 64.9        |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 70.7        |
|    ep_rew_mean          | 56.4        |
| time/                   |             |
|    fps                  | 23          |
|    iterations           | 6           |
|    time_elapsed         | 519         |
|    total_timesteps      | 12288       |
| train/                  |             |
|    approx_kl            | 0.014402417 |
|    clip_fraction        | 0.151       |
|    clip_range           | 0.2         |
|    entropy_loss         | -9.94       |
|    explained_variance   | -0.00047    |
|    learning_rate        | 0.0003      |
|    loss                 | 32.3        |
|    n_updates            | 50          |
|    policy_gradient_loss | -0.0372     |
|    std                  | 1           |
|    value_loss           | 82.7        |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 70.3        |
|    ep_rew_mean          | 73          |
| time/                   |             |
|    fps                  | 23          |
|    iterations           | 7           |
|    time_elapsed         | 605         |
|    total_timesteps      | 14336       |
| train/                  |             |
|    approx_kl            | 0.015431382 |
|    clip_fraction        | 0.17        |
|    clip_range           | 0.2         |
|    entropy_loss         | -9.92       |
|    explained_variance   | 0.0582      |
|    learning_rate        | 0.0003      |
|    loss                 | 43.9        |
|    n_updates            | 60          |
|    policy_gradient_loss | -0.0451     |
|    std                  | 0.997       |
|    value_loss           | 85.8        |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 67.9        |
|    ep_rew_mean          | 73.1        |
| time/                   |             |
|    fps                  | 22          |
|    iterations           | 8           |
|    time_elapsed         | 729         |
|    total_timesteps      | 16384       |
| train/                  |             |
|    approx_kl            | 0.011194373 |
|    clip_fraction        | 0.157       |
|    clip_range           | 0.2         |
|    entropy_loss         | -9.91       |
|    explained_variance   | 0.00241     |
|    learning_rate        | 0.0003      |
|    loss                 | 932         |
|    n_updates            | 70          |
|    policy_gradient_loss | -0.0159     |
|    std                  | 0.996       |
|    value_loss           | 8.57e+03    |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 66.6        |
|    ep_rew_mean          | 71.7        |
| time/                   |             |
|    fps                  | 21          |
|    iterations           | 9           |
|    time_elapsed         | 856         |
|    total_timesteps      | 18432       |
| train/                  |             |
|    approx_kl            | 0.015136489 |
|    clip_fraction        | 0.147       |
|    clip_range           | 0.2         |
|    entropy_loss         | -9.91       |
|    explained_variance   | 0.044       |
|    learning_rate        | 0.0003      |
|    loss                 | 66.3        |
|    n_updates            | 80          |
|    policy_gradient_loss | -0.04       |
|    std                  | 0.996       |
|    value_loss           | 243         |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 67.3        |
|    ep_rew_mean          | 55.3        |
| time/                   |             |
|    fps                  | 20          |
|    iterations           | 10          |
|    time_elapsed         | 977         |
|    total_timesteps      | 20480       |
| train/                  |             |
|    approx_kl            | 0.020248398 |
|    clip_fraction        | 0.22        |
|    clip_range           | 0.2         |
|    entropy_loss         | -9.89       |
|    explained_variance   | 0.0157      |
|    learning_rate        | 0.0003      |
|    loss                 | 64.3        |
|    n_updates            | 90          |
|    policy_gradient_loss | -0.0485     |
|    std                  | 0.993       |
|    value_loss           | 122         |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 68.7        |
|    ep_rew_mean          | 56.3        |
| time/                   |             |
|    fps                  | 21          |
|    iterations           | 11          |
|    time_elapsed         | 1054        |
|    total_timesteps      | 22528       |
| train/                  |             |
|    approx_kl            | 0.027708348 |
|    clip_fraction        | 0.282       |
|    clip_range           | 0.2         |
|    entropy_loss         | -9.88       |
|    explained_variance   | 0.016       |
|    learning_rate        | 0.0003      |
|    loss                 | 62.9        |
|    n_updates            | 100         |
|    policy_gradient_loss | -0.0521     |
|    std                  | 0.991       |
|    value_loss           | 113         |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 66.4        |
|    ep_rew_mean          | 52.7        |
| time/                   |             |
|    fps                  | 21          |
|    iterations           | 12          |
|    time_elapsed         | 1133        |
|    total_timesteps      | 24576       |
| train/                  |             |
|    approx_kl            | 0.025001531 |
|    clip_fraction        | 0.242       |
|    clip_range           | 0.2         |
|    entropy_loss         | -9.85       |
|    explained_variance   | -0.0591     |
|    learning_rate        | 0.0003      |
|    loss                 | 47.9        |
|    n_updates            | 110         |
|    policy_gradient_loss | -0.0491     |
|    std                  | 0.987       |
|    value_loss           | 105         |
-----------------------------------------
----------------------------------------
| rollout/                |            |
|    ep_len_mean          | 67.6       |
|    ep_rew_mean          | 53.7       |
| time/                   |            |
|    fps                  | 21         |
|    iterations           | 13         |
|    time_elapsed         | 1226       |
|    total_timesteps      | 26624      |
| train/                  |            |
|    approx_kl            | 0.03725663 |
|    clip_fraction        | 0.306      |
|    clip_range           | 0.2        |
|    entropy_loss         | -9.83      |
|    explained_variance   | -0.0227    |
|    learning_rate        | 0.0003     |
|    loss                 | 37.6       |
|    n_updates            | 120        |
|    policy_gradient_loss | -0.0652    |
|    std                  | 0.983      |
|    value_loss           | 109        |
----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 68.2        |
|    ep_rew_mean          | 54.5        |
| time/                   |             |
|    fps                  | 22          |
|    iterations           | 14          |
|    time_elapsed         | 1298        |
|    total_timesteps      | 28672       |
| train/                  |             |
|    approx_kl            | 0.037424594 |
|    clip_fraction        | 0.366       |
|    clip_range           | 0.2         |
|    entropy_loss         | -9.8        |
|    explained_variance   | 0.026       |
|    learning_rate        | 0.0003      |
|    loss                 | 41.8        |
|    n_updates            | 130         |
|    policy_gradient_loss | -0.061      |
|    std                  | 0.979       |
|    value_loss           | 101         |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 71.2        |
|    ep_rew_mean          | 56.9        |
| time/                   |             |
|    fps                  | 21          |
|    iterations           | 15          |
|    time_elapsed         | 1396        |
|    total_timesteps      | 30720       |
| train/                  |             |
|    approx_kl            | 0.037746213 |
|    clip_fraction        | 0.351       |
|    clip_range           | 0.2         |
|    entropy_loss         | -9.78       |
|    explained_variance   | 0.0887      |
|    learning_rate        | 0.0003      |
|    loss                 | 36          |
|    n_updates            | 140         |
|    policy_gradient_loss | -0.0687     |
|    std                  | 0.976       |
|    value_loss           | 96.3        |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 69.9        |
|    ep_rew_mean          | 55.8        |
| time/                   |             |
|    fps                  | 22          |
|    iterations           | 16          |
|    time_elapsed         | 1477        |
|    total_timesteps      | 32768       |
| train/                  |             |
|    approx_kl            | 0.040257197 |
|    clip_fraction        | 0.383       |
|    clip_range           | 0.2         |
|    entropy_loss         | -9.76       |
|    explained_variance   | 0.0474      |
|    learning_rate        | 0.0003      |
|    loss                 | 37.7        |
|    n_updates            | 150         |
|    policy_gradient_loss | -0.0602     |
|    std                  | 0.974       |
|    value_loss           | 104         |
-----------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 67.9        |
|    ep_rew_mean          | 54.4        |
| time/                   |             |
|    fps                  | 21          |
|    iterations           | 17          |
|    time_elapsed         | 1587        |
|    total_timesteps      | 34816       |
| train/                  |             |
|    approx_kl            | 0.045620125 |
|    clip_fraction        | 0.346       |
|    clip_range           | 0.2         |
|    entropy_loss         | -9.75       |
|    explained_variance   | 0.000816    |
|    learning_rate        | 0.0003      |
|    loss                 | 29.5        |
|    n_updates            | 160         |
|    policy_gradient_loss | -0.0648     |
|    std                  | 0.973       |
|    value_loss           | 96.4        |
-----------------------------------------
---------------------------------------
| rollout/                |           |
|    ep_len_mean          | 68.1      |
|    ep_rew_mean          | 54.4      |
| time/                   |           |
|    fps                  | 22        |
|    iterations           | 18        |
|    time_elapsed         | 1662      |
|    total_timesteps      | 36864     |
| train/                  |           |
|    approx_kl            | 0.0522881 |
|    clip_fraction        | 0.412     |
|    clip_range           | 0.2       |
|    entropy_loss         | -9.72     |
|    explained_variance   | -0.0816   |
|    learning_rate        | 0.0003    |
|    loss                 | 51.8      |
|    n_updates            | 170       |
|    policy_gradient_loss | -0.0585   |
|    std                  | 0.968     |
|    value_loss           | 101       |
---------------------------------------
-----------------------------------------
| rollout/                |             |
|    ep_len_mean          | 71.1        |
|    ep_rew_mean          | 56.4        |
| time/                   |             |
|    fps                  | 22          |
|    iterations           | 19          |
|    time_elapsed         | 1732        |
|    total_timesteps      | 38912       |
| train/                  |             |
|    approx_kl            | 0.046213496 |
|    clip_fraction        | 0.39        |
|    clip_range           | 0.2         |
|    entropy_loss         | -9.71       |
|    explained_variance   | 0.0858      |
|    learning_rate        | 0.0003      |
|    loss                 | 47.4        |
|    n_updates            | 180         |
|    policy_gradient_loss | -0.068      |
|    std                  | 0.967       |
|    value_loss           | 89.5        |
-----------------------------------------
/home/yyan-admin/yl43338/residual_grasping/envs/one_step_end2end_grasp.py:425: UserWarning: Calling Done after catching RuntimeError
  except RuntimeError as e:
/home/yyan-admin/yl43338/residual_grasping/envs/one_step_end2end_grasp.py:426: UserWarning: SceneGraph encountered a non-finite value (e.g., NaN or infinity) on a pose input port. It came from the input associated with source id 16 and name 'plant'.
  warnings.warn("Calling Done after catching RuntimeError")
Traceback (most recent call last):
  File "/home/yyan-admin/yl43338/residual_grasping/train_one_step_e2e.py", line 126, in <module>
  File "/home/yyan-admin/yl43338/residual_grasping/train_one_step_e2e.py", line 113, in main
  File "/home/yyan-admin/yl43338/env/lib/python3.10/site-packages/stable_baselines3/ppo/ppo.py", line 311, in learn
    return super().learn(
  File "/home/yyan-admin/yl43338/env/lib/python3.10/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 324, in learn
    continue_training = self.collect_rollouts(self.env, callback, self.rollout_buffer, n_rollout_steps=self.n_steps)
  File "/home/yyan-admin/yl43338/env/lib/python3.10/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 218, in collect_rollouts
    new_obs, rewards, dones, infos = env.step(clipped_actions)
  File "/home/yyan-admin/yl43338/env/lib/python3.10/site-packages/stable_baselines3/common/vec_env/base_vec_env.py", line 222, in step
    return self.step_wait()
  File "/home/yyan-admin/yl43338/env/lib/python3.10/site-packages/stable_baselines3/common/vec_env/dummy_vec_env.py", line 71, in step_wait
    obs, self.reset_infos[env_idx] = self.envs[env_idx].reset()
  File "/home/yyan-admin/yl43338/env/lib/python3.10/site-packages/stable_baselines3/common/monitor.py", line 83, in reset
    return self.env.reset(**kwargs)
  File "/home/yyan-admin/yl43338/env/lib/python3.10/site-packages/gymnasium/wrappers/common.py", line 400, in reset
    return super().reset(seed=seed, options=options)
  File "/home/yyan-admin/yl43338/env/lib/python3.10/site-packages/gymnasium/core.py", line 333, in reset
    return self.env.reset(seed=seed, options=options)
  File "/home/yyan-admin/yl43338/env/lib/python3.10/site-packages/gymnasium/wrappers/common.py", line 295, in reset
    return self.env.reset(seed=seed, options=options)
  File "/home/yyan-admin/yl43338/env/lib/python3.10/site-packages/pydrake/gym/_drake_gym_env.py", line 299, in reset
    self.simulator.Initialize()
RuntimeError: SceneGraph encountered a non-finite value (e.g., NaN or infinity) on a pose input port. It came from the input associated with source id 16 and name 'plant'.
Traceback (most recent call last):
  File "/home/yyan-admin/yl43338/residual_grasping/train_one_step_e2e.py", line 126, in <module>
  File "/home/yyan-admin/yl43338/residual_grasping/train_one_step_e2e.py", line 113, in main
  File "/home/yyan-admin/yl43338/env/lib/python3.10/site-packages/stable_baselines3/ppo/ppo.py", line 311, in learn
    return super().learn(
  File "/home/yyan-admin/yl43338/env/lib/python3.10/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 324, in learn
    continue_training = self.collect_rollouts(self.env, callback, self.rollout_buffer, n_rollout_steps=self.n_steps)
  File "/home/yyan-admin/yl43338/env/lib/python3.10/site-packages/stable_baselines3/common/on_policy_algorithm.py", line 218, in collect_rollouts
    new_obs, rewards, dones, infos = env.step(clipped_actions)
  File "/home/yyan-admin/yl43338/env/lib/python3.10/site-packages/stable_baselines3/common/vec_env/base_vec_env.py", line 222, in step
    return self.step_wait()
  File "/home/yyan-admin/yl43338/env/lib/python3.10/site-packages/stable_baselines3/common/vec_env/dummy_vec_env.py", line 71, in step_wait
    obs, self.reset_infos[env_idx] = self.envs[env_idx].reset()
  File "/home/yyan-admin/yl43338/env/lib/python3.10/site-packages/stable_baselines3/common/monitor.py", line 83, in reset
    return self.env.reset(**kwargs)
  File "/home/yyan-admin/yl43338/env/lib/python3.10/site-packages/gymnasium/wrappers/common.py", line 400, in reset
    return super().reset(seed=seed, options=options)
  File "/home/yyan-admin/yl43338/env/lib/python3.10/site-packages/gymnasium/core.py", line 333, in reset
    return self.env.reset(seed=seed, options=options)
  File "/home/yyan-admin/yl43338/env/lib/python3.10/site-packages/gymnasium/wrappers/common.py", line 295, in reset
    return self.env.reset(seed=seed, options=options)
  File "/home/yyan-admin/yl43338/env/lib/python3.10/site-packages/pydrake/gym/_drake_gym_env.py", line 299, in reset
    self.simulator.Initialize()
RuntimeError: SceneGraph encountered a non-finite value (e.g., NaN or infinity) on a pose input port. It came from the input associated with source id 16 and name 'plant'.
